<!DOCTYPE html>
<html lang="en">

  <head>
    
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Pollen, a new programming language for tiny computers by Amaret, Inc.">
    <meta name="keywords" content="programming, programming languages, languages, hardware, microcontroller, embedded system, embedded systems, embedded systems programming, embedded development, microcontroller software, microcontroller software development">
    <meta name="author" content="Amaret, Inc.">

    <title>Getting started with Pollen</title>

    <!-- Bootstrap core CSS -->
    <link href="../static/css/bootstrap.css" rel="stylesheet" />

    <!-- Prism CSS -->
    <link href="../static/css/prism.css" rel="stylesheet" />

    <!-- Amaret core CSS -->
    <link href="../static/css/pollen.css" rel="stylesheet" />

    <!-- Favicons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="static/ico/apple-touch-icon-144-precomposed.png">
    <link rel="icon" href="static/ico/favicon.ico">

    <!-- analytics --> 
    <script></script>
  </head>

  <body class="doc-page language-javascript" data-spy="scroll" data-target="#doc-sidenav">

    <div class="navbar navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://localhost/~amichi/pollen/index.html">Pollen</a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li id="introduction"><a href="http://localhost/~amichi/pollen/introduction/index.html">Introduction</a></li>
        <li><a href="http://localhost/~amichi/pollen/guide/index.html">Language Guide</a></li>
        <li><a href="http://localhost/~amichi/pollen/reference/index.html">Reference</a></li>
        <li><a href="http://localhost/~amichi/pollen/compiler/index.html">Compiler</a></li>
        <li><a href="">Support</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="">About</a></li>
      </ul>
    </div>
  </div>
  <div class="alert alert-warning" role="alert" style="text-align: center; margin: 0">
    <p><span class="glyphicon glyphicon-road" aria-hidden="true"></span> This documentation is being worked on and is not yet in a releasable state. &nbsp;2015-04-21</p>
  <p>  </p>
</div>

</div>



    <div class="doc-header draft-mode">
      <div class="container">
        <h1>Getting started with Pollen</h1>
        <p>Quickly compile and run your first program on a target</p>
      </div>
    </div>

    <div class="container doc-container" style="padding-bottom: 60px">
      <div class="row" id="content">
        <div class="col-md-3">
  <div class="doc-sidebar hidden-print hidden-xs hidden-sm affix" role="complementary">
    <ul class="nav doc-sidenav">
  <li class="active"><a href="#">Overview</a></li>
  <li><a href="#">Reports</a></li>
  <li><a href="#">Analytics</a></li>
  <li><a href="#">Export</a></li>
</ul>

  </div>
</div>

<div class="col-md-9" role="main">
  <h1 class="page-header">Overview</h1>
  <p>We will quickly walk you through the steps to get your first pollen program compiled and running!</p>

  <h1 class="page-header">The Program</h1>
  <p>The canonical "Hello, World!" program for hardware applications, blinking an Led. This highly efficient version is not your typical infinte loop-delay blink. This one makes use of an event based timer which toggles an Led periodically and allows the system to do other things in the interm, or if there is nothing to be done, go into a low-power mode, saving power.</p>
    <pre><code>import pollen.environment as MyBoard
from MyBoard import Led
  
from pollen.time import Timer
  
module Blink {
  
  host Timer t1 = new Timer(tick)     // Declare and allocate a timer with a tick() handler

  tick() {
    Led.toggle()                      // Toggle the Led (blink)
  }

  pollen.run() {
    t1.start(500, true)               // Start the timer, 500ms, repeating
    MyBoard.run()                     // Start the event system
  }   
}
    </code></pre>

  <h1 class="page-header">Building Pollen<h1>

  <h3>Download <strong>pollenc</strong></h3>

  <h1 class="page-header">Running Code</h1>

  <h3>Run code on your machine</h3>

  <h3>Load your code onto a microcontroller</h3>


  <hr>
  
<h1 id="getting-started-with-pollen">Getting Started with Pollen</h1>

<p>Pollen is available as a cloud compiler. You do not need to download it. </p>

<p>The python script that runs the Pollen in the cloud is called <code>pollenc.py</code> and it can be downloaded from <code>WHERE?</code>.  To see all the options run <code>pollenc.py -h</code> in a terminal window. </p>

<p>In this example we will show how to use Pollen with a simple example that uses a timer to blink an led. We will translate it for two targets: the Arduino Uno and local host.  In the other ‘How To’ sections we will be exploring a variety of aspects of this example application. We will look at the code itself and also the types it uses. In this section we will focus on how to use the cloud compiler. </p>

<p>Here is the blink application. Copy and paste it locally into a file <code>TimerBlink.p</code>:</p>

<pre><code>import pollen.environment as Env
from Env import Led
  
from pollen.time import Timer
  
module TimerBlink {
  
  host new Timer t1(tick)    // Declare and allocate a timer with a tick() handler

  tick() {
    Led.toggle()            // Toggle (blink) an Led
  }

  pollen.run() {
    t1.start(500, true)      // Start the timer
    Env.Newsroom.run()
  }   }
</code></pre>

<p>The Pollen translator is invoked with a top level module, options, and a set of bundles.  The top level module is the file that contains the entry point <code>pollen.run()</code> (this is the main entry, like <code>main()</code> in C) and it is supplied last on the command line.  That means in our example <code>TimerBlink.p</code> should appear last on the command line. </p>

<p>When given a bundle, the translator will handle it as a collection and process all the contained packages.  A bundle is a named directory which contains a collection of packages.  Packages are directories containing Pollen types.</p>

<p>The top level module uses the import statement to import the units it needs. These units must be found in the set of bundles supplied to the Pollen translator. In our <code>TimerBlink</code> example <code>Timer</code> and <code>Led</code> are imported.</p>

<p>Cloud compiler output consists of messages and files. The Pollen translator checks the code and translates it to C if there are no Pollen errors, then the appropriate C compiler runs (in the cloud). If there are no errors the code will be linked and downloaded. Depending on the target there may be other tools run on the output (for example, objcopy). </p>

<p>Here is the command line to translate this Pollen file into C for the Arduino Uno. You must supply a local directory path for <output path="">.</output></p>

<pre><code>pollenc.py                            \
  -o &lt;output path&gt;                    \    
  -t avr-gcc                          \
  -m atmega328p                       \
  -b @pollen-core                     \
  -b @atmel                           \
  -b @environments                    \
  -e @environments/arduino/Uno        \
  TimerBlink.p                        \
</code></pre>

<p>(Note the most current list of supported options are available as the output of <code>pollen.py --help</code>.)</p>

<p>The <code>-o</code> (or <code>--out</code>) option specifies the local path to the output files.</p>

<p>The <code>-t</code> (or <code>--toolchain</code>) option specifies the toolchain. Current supported toolchains include avr-gcc,
arm-none-eabi-gcc, and localhost-gcc. The toolchain includes the compiler but may also incorporate other tools (such as avrdude and objcopy).</p>

<p>The option <code>-m</code> (or <code>--mcu</code>) option specifies the target microcontroller. Valid values for this option depend on the toolchain. (Note that if the toolchain is <code>localhost-gcc</code> this option is not supported.)</p>

<p>The option <code>-b</code> (or <code>--bundle</code>) specificies a bundle. In this case cloud bundles are used which is signified by <code>@</code> before the bundle name. These bundles reside in the cloud and support a variety of essential types, services, and hardware. Cloud bundles can be downloaded for inspection or modification. </p>

<p>The option <code>-e</code> (or <code>--environment</code>) is the option to specify an environment. For more information on this option see the ‘How To’ section on specifying <code>pollen.environment</code>.</p>

<p>The C compiler output file will have the name TimerBlink-prog.out (or <top level="" module="" name="">-prog.out in the general case). It will be located under the output directory specified with `-o`.</top></p>

<p>Note that other tools may run on that file (e.g. objcopy) so  what the final executeable name will be depends on the toolchain used.</p>

<p>Here is the cloud compiler command line to translate the <code>TimerBlink</code> program for the localhost:</p>

<pre><code>pollenc.py -o &lt;output path&gt; -t localhost-gcc -b @pollen-core  -b @localhost   -b @environments  \ 
           -e @environments/localhost/LocalHost TimerBlink.p
</code></pre>

<p>The values for the <code>-t</code> and <code>-e</code> options have changed and the `-m] option is not supplied (because it is not meaningful in the localhost context). </p>

<p>Find the file TimerBlink-prog.out in the output directory and then run this file on your local host.  This file will produce the following output:</p>

<pre><code>Pin.clear
Pin.makeOutput
Pin.set
Pin.clear
Pin.set
Pin.clear
Pin.set
Pin.clear
Pin.set
Pin.clear
Pin.set
Pin.clear
</code></pre>

<p>This is simply printing out a trace of called routines. Translating your Pollen application for the target localhost can provide a useful verification step before you download and run your application on target hardware.  One thing that is happening here is that the Pollen print statement is mapped to local host print functionality. This will be explored in detail in the section on how to use the Pollen print statement.</p>

  
</div>

      </div>
    </div>

        <footer class="" role="contentinfo">
      <div class="container section">

          <div class="container">
            <a data-scroll href="http://amaret.com"><img class="brand-logo" src="../static/img/logo_white_medium.png" /></a>
            <h3 style="margin-top: 0">Integrated Solutions for Product Creation</h3>
            <p>
              Copyright &copy; 2015 Amaret Inc. All rights reserved. <!-- <a href="">Terms of Use</a> &nbsp;|&nbsp;  <a href="">Privacy Policy</a> -->
            </p>
          </div>

      </div>
    </footer>

    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="../static/js/pollen.js"></script>
    <script src="../static/js/prism.js"></script>


  </body>

</html>
